var v=Object.defineProperty;var P=(f,t,i)=>t in f?v(f,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):f[t]=i;var s=(f,t,i)=>P(f,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}})();class d{constructor(t=0,i=0){this.x=t,this.y=i}add(t){return new d(this.x+t.x,this.y+t.y)}subtract(t){return new d(this.x-t.x,this.y-t.y)}multiply(t){return new d(this.x*t,this.y*t)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.magnitude();return t===0?new d:new d(this.x/t,this.y/t)}distance(t){return this.subtract(t).magnitude()}clone(){return new d(this.x,this.y)}}class E{constructor(t,i,e="yellow"){s(this,"position");s(this,"velocity");s(this,"acceleration");s(this,"width");s(this,"height");s(this,"rotation");s(this,"gravity");s(this,"flapStrength");s(this,"maxSpeed");s(this,"color");s(this,"sprites");s(this,"currentFrame");s(this,"frameTimer");s(this,"frameDuration");s(this,"hasShield");s(this,"shieldTimer");s(this,"shieldDuration");this.position=new d(t,i),this.velocity=new d(0,0),this.acceleration=new d(0,0),this.width=34,this.height=24,this.rotation=0,this.gravity=900,this.flapStrength=-350,this.maxSpeed=400,this.color=e,this.sprites=[],this.loadSprites(),this.currentFrame=0,this.frameTimer=0,this.frameDuration=.1,this.hasShield=!1,this.shieldTimer=0,this.shieldDuration=5}loadSprites(){[`${this.color}bird-downflap.png`,`${this.color}bird-midflap.png`,`${this.color}bird-upflap.png`].forEach(i=>{const e=new Image;e.src=`./assets/sprites/${i}`,this.sprites.push(e)})}setColor(t){this.color=t,this.sprites=[],this.loadSprites()}activateShield(){this.hasShield=!0,this.shieldTimer=0}flap(){this.velocity.y=this.flapStrength}update(t){this.acceleration.y=this.gravity,this.velocity.y+=this.acceleration.y*t,this.velocity.y>this.maxSpeed&&(this.velocity.y=this.maxSpeed),this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t;const i=this.velocity.y>0?Math.min(Math.PI/4,this.velocity.y/this.maxSpeed*Math.PI/2):Math.max(-Math.PI/6,this.velocity.y/this.flapStrength*Math.PI/6);this.rotation=this.rotation+(i-this.rotation)*5*t,this.frameTimer+=t,this.frameTimer>=this.frameDuration&&(this.frameTimer=0,this.currentFrame=(this.currentFrame+1)%this.sprites.length),this.hasShield&&(this.shieldTimer+=t,this.shieldTimer>=this.shieldDuration&&(this.hasShield=!1))}render(t){if(t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.rotation),this.sprites.length>0&&this.sprites[this.currentFrame].complete)t.drawImage(this.sprites[this.currentFrame],-this.width/2,-this.height/2,this.width,this.height);else{let i="#f8e71c";this.color==="red"&&(i="#e74c3c"),this.color==="blue"&&(i="#3498db"),t.fillStyle=i,t.fillRect(-this.width/2,-this.height/2,this.width,this.height)}if(this.hasShield){const i=Math.max(this.width,this.height)*.8,e=1+Math.sin(this.shieldTimer*5)*.1,o=Math.min(1,(this.shieldDuration-this.shieldTimer)/1.5),n=t.createRadialGradient(0,0,0,0,0,i*e);n.addColorStop(0,"rgba(52, 152, 219, 0.1)"),n.addColorStop(.7,"rgba(52, 152, 219, 0.3)"),n.addColorStop(1,"rgba(52, 152, 219, 0)"),t.globalAlpha=o,t.fillStyle=n,t.beginPath(),t.arc(0,0,i*e,0,Math.PI*2),t.fill(),t.strokeStyle="rgba(52, 152, 219, "+o+")",t.lineWidth=2,t.beginPath(),t.arc(0,0,i*e,0,Math.PI*2),t.stroke(),t.globalAlpha=1}t.restore()}collidesWith(t){const e=this.position.x-this.width/2+4,o=this.position.x+this.width/2-4,n=this.position.y-this.height/2+4,h=this.position.y+this.height/2-4;let a,r,l,p;if("isTop"in t){const c=t;a=c.position.x-c.width/2,r=a+c.width,c.isTop?(l=c.position.y-c.height,p=c.position.y):(l=c.position.y,p=c.position.y+c.height)}else a=t.position.x-t.width/2,r=a+t.width,l=t.position.y-t.height/2,p=l+t.height;return e<r&&o>a&&n<p&&h>l}}class I{constructor(t,i,e,o,n=u){s(this,"position");s(this,"velocity");s(this,"width");s(this,"height");s(this,"sprite");this.position=new d(t,i),this.velocity=new d(-n,0),this.width=e,this.height=o,this.sprite=new Image,this.sprite.src="./assets/sprites/base.png"}update(t){this.position.x+=this.velocity.x*t,this.position.x<-this.width*.9&&(this.position.x+=this.width*2)}setSpeed(t){this.velocity.x=-t}render(t){if(this.sprite.complete)t.drawImage(this.sprite,this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height);else{t.fillStyle="#DED895",t.fillRect(this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height),t.strokeStyle="#85643B",t.lineWidth=3,t.beginPath(),t.moveTo(this.position.x-this.width/2,this.position.y-this.height/2),t.lineTo(this.position.x+this.width/2,this.position.y-this.height/2),t.stroke(),t.fillStyle="#8ED943";for(let i=0;i<this.width;i+=30){const e=this.position.x-this.width/2+i,o=5+Math.random()*5;t.fillRect(e,this.position.y-this.height/2-o,10,o)}}}collidesWith(t){const i=this.width/2,e=this.height/2,o=t.width/2,n=t.height/2,h=Math.abs(this.position.x-t.position.x),a=Math.abs(this.position.y-t.position.y);return h<i+o&&a<e+n}}class b{constructor(t,i,e,o,n=!1,h=u){s(this,"position");s(this,"velocity");s(this,"width");s(this,"height");s(this,"isTop");s(this,"isSpecial");s(this,"isPassed");s(this,"sprite");this.position=new d(t,i),this.velocity=new d(-h,0),this.width=52,this.height=e,this.isTop=o,this.isSpecial=n,this.isPassed=!1,this.sprite=new Image,this.sprite.src=this.isSpecial?"./assets/sprites/pipe-red.png":"./assets/sprites/pipe-green.png"}update(t){this.position.x+=this.velocity.x*t}render(t){if(this.sprite.complete){const i=this.position.x-this.width/2;this.isTop?(t.save(),t.translate(i+this.width/2,this.position.y),t.scale(1,-1),t.drawImage(this.sprite,-this.width/2,0,this.width,this.height),t.restore()):t.drawImage(this.sprite,i,this.position.y,this.width,this.height)}else{t.fillStyle=this.isSpecial?"#E73C3C":"#74BF2E";const i=this.position.x-this.width/2,e=this.isTop?this.position.y-this.height:this.position.y;t.fillRect(i,e,this.width,this.height);const o=20,n=this.width+10;t.fillRect(this.position.x-n/2,this.isTop?this.position.y-this.height-o:this.position.y,n,o)}}collidesWith(t){const i=this.position.x-this.width/2,e=i+this.width,o=this.isTop?this.position.y-this.height:this.position.y,n=this.isTop?this.position.y:this.position.y+this.height,h=t.position.x-t.width/2,a=h+t.width,r=t.position.y-t.height/2,l=r+t.height;return i<a&&e>h&&o<l&&n>r}checkPassed(t){const i=this.position.x+this.width/2;return this.isTop&&!this.isPassed&&t>i?(this.isPassed=!0,!0):!1}}class x{constructor(t,i){s(this,"position");s(this,"velocity");s(this,"width");s(this,"height");s(this,"layers");s(this,"backgroundImage");s(this,"currentSpeed");this.position=new d(t/2,i/2),this.velocity=new d(0,0),this.width=t,this.height=i,this.currentSpeed=u,this.backgroundImage=new Image,this.backgroundImage.src="./assets/sprites/background-day.png",this.layers=[new T("#DED895",0,i-112,t,112,1,!1,"ground",!0)]}update(t){for(const i of this.layers)i.update(t,this.currentSpeed)}setSpeed(t){this.currentSpeed=t}render(t){const i=this.height-112,e=this.backgroundImage.width,o=Math.ceil(this.width/e)+1;for(let n=0;n<o;n++)t.drawImage(this.backgroundImage,n*e,0,e,i);for(const n of this.layers)n.render(t)}collidesWith(t){return!1}}class T{constructor(t,i,e,o,n,h,a=!1,r="medium",l=!1){s(this,"color");s(this,"x");s(this,"y");s(this,"width");s(this,"height");s(this,"speedFactor");s(this,"segments");s(this,"isCityscape");s(this,"cloudType");s(this,"isGround");s(this,"groundImage",null);this.color=t,this.x=i,this.y=e,this.width=o,this.height=n,this.speedFactor=h,this.isCityscape=a,this.cloudType=r,this.isGround=l,this.segments=[{x:0,width:o},{x:o,width:o},{x:o*2,width:o}],l&&(this.groundImage=new Image,this.groundImage.src="/assets/sprites/base.png")}update(t,i=u){if(this.speedFactor!==0){for(let e=0;e<this.segments.length;e++)if(this.segments[e].x-=i*this.speedFactor*t,this.segments[e].x<=-this.width){const o=e===0?this.segments.length-1:e-1;this.segments[e].x=this.segments[o].x+this.width}}}render(t){if(this.isGround&&this.groundImage){for(const i of this.segments){const e=this.groundImage.width,o=Math.ceil(i.width/e)+1;for(let n=0;n<o;n++){const h=i.x+n*e;h<-e||h>i.width||t.drawImage(this.groundImage,h,this.y,e,this.height)}}return}if(t.fillStyle=this.color,this.speedFactor===0){t.fillRect(0,0,this.width,this.height);return}}}class M{constructor(t,i,e="+1"){s(this,"position");s(this,"velocity");s(this,"width");s(this,"height");s(this,"opacity");s(this,"scale");s(this,"lifetime");s(this,"maxLifetime");s(this,"text");this.position=new d(t,i),this.velocity=new d(0,-60),this.width=40,this.height=40,this.opacity=1,this.scale=1,this.lifetime=0,this.maxLifetime=1.5,this.text=e}update(t){this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.lifetime+=t;const i=this.lifetime/this.maxLifetime;i<.2?(this.scale=1+i*2,this.opacity=1):(this.scale=1.4-(i-.2)*.5,this.opacity=1-(i-.2)*1.25)}render(t){this.opacity<=0||(t.save(),t.font=`bold ${Math.floor(30*this.scale)}px Arial`,t.textAlign="center",t.textBaseline="middle",t.fillStyle="rgba(0, 0, 0, "+this.opacity*.5+")",t.fillText(this.text,this.position.x+2,this.position.y+2),t.fillStyle="rgba(255, 255, 255, "+this.opacity+")",t.fillText(this.text,this.position.x,this.position.y),t.restore())}isExpired(){return this.lifetime>=this.maxLifetime}collidesWith(t){return!1}}class k{constructor(t,i,e){s(this,"position");s(this,"velocity");s(this,"width");s(this,"height");s(this,"type");s(this,"isCollected");s(this,"animationTimer");s(this,"bobAmount");s(this,"rotationAngle");this.position=new d(t,i),this.velocity=new d(-200,0),this.width=40,this.height=40,this.type=e,this.isCollected=!1,this.animationTimer=0,this.bobAmount=10,this.rotationAngle=0}update(t){this.position.x+=this.velocity.x*t,this.animationTimer+=t;const i=Math.sin(this.animationTimer*3)*this.bobAmount;this.position.y=this.position.y-i*t*5,this.rotationAngle+=t*2,this.rotationAngle>Math.PI*2&&(this.rotationAngle-=Math.PI*2)}setSpeed(t){this.velocity.x=-t}render(t){t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.rotationAngle);const i=this.width/2,e=this.height/2,o=t.createRadialGradient(0,0,5,0,0,i);switch(this.type){case"shield":o.addColorStop(0,"rgba(52, 152, 219, 1)"),o.addColorStop(1,"rgba(52, 152, 219, 0)");break;case"slowmo":o.addColorStop(0,"rgba(155, 89, 182, 1)"),o.addColorStop(1,"rgba(155, 89, 182, 0)");break;case"score":o.addColorStop(0,"rgba(241, 196, 15, 1)"),o.addColorStop(1,"rgba(241, 196, 15, 0)");break}switch(t.fillStyle=o,t.beginPath(),t.arc(0,0,i,0,Math.PI*2),t.fill(),t.fillStyle="white",t.strokeStyle="black",t.lineWidth=2,this.type){case"shield":t.beginPath(),t.moveTo(0,-e*.5),t.lineTo(i*.6,e*.3),t.lineTo(0,e*.7),t.lineTo(-i*.6,e*.3),t.closePath(),t.fill(),t.stroke();break;case"slowmo":t.beginPath(),t.arc(0,0,i*.6,0,Math.PI*2),t.fill(),t.stroke(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-e*.4),t.stroke(),t.beginPath(),t.moveTo(0,0),t.lineTo(i*.3,0),t.stroke();break;case"score":const n=5,h=i*.7,a=h*.4;t.beginPath();for(let r=0;r<n*2;r++){const l=r%2===0?h:a,p=Math.PI/n*r-Math.PI/2,c=l*Math.cos(p),g=l*Math.sin(p);r===0?t.moveTo(c,g):t.lineTo(c,g)}t.closePath(),t.fill(),t.stroke();break}t.restore()}collidesWith(t){const i=this.width/2,e=this.height/2,o=t.width/2,n=t.height/2,h=Math.abs(this.position.x-t.position.x),a=Math.abs(this.position.y-t.position.y);return h<i+o&&a<e+n}}class B{constructor(t,i,e){s(this,"position");s(this,"velocity");s(this,"width");s(this,"height");s(this,"type");s(this,"lifetime");s(this,"maxLifetime");s(this,"scale");s(this,"opacity");this.position=new d(t,i),this.velocity=new d(0,-50),this.width=80,this.height=80,this.type=e,this.lifetime=0,this.maxLifetime=1.5,this.scale=.5,this.opacity=1}update(t){this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.lifetime+=t;const i=this.lifetime/this.maxLifetime;i<.3?(this.scale=.5+i/.3*.5,this.opacity=Math.min(1,i*3)):(this.scale=1,this.opacity=Math.max(0,1-(i-.3)/.7))}isExpired(){return this.lifetime>=this.maxLifetime}render(t){t.save(),t.globalAlpha=this.opacity,t.translate(this.position.x,this.position.y),t.scale(this.scale,this.scale),this.width/2,this.height/2,t.fillStyle="white",t.strokeStyle="black",t.lineWidth=3,t.font="bold 20px Arial",t.textAlign="center",t.textBaseline="middle";let i="";switch(this.type){case"shield":i="SHIELD!",t.fillStyle="#3498db";break;case"slowmo":i="SLOW-MO!",t.fillStyle="#9b59b6";break;case"score":i="DOUBLE SCORE!",t.fillStyle="#f1c40f";break}t.shadowColor="rgba(0, 0, 0, 0.5)",t.shadowBlur=5,t.shadowOffsetX=2,t.shadowOffsetY=2,t.strokeText(i,0,0),t.fillText(i,0,0),t.restore()}collidesWith(t){return!1}}class L{constructor(){s(this,"keys",{});s(this,"mouseDown",!1);s(this,"touchActive",!1);s(this,"isFlapping",!1);this.keys={},this.addEventListeners()}addEventListeners(){window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this)),window.addEventListener("mousedown",this.handleMouseDown.bind(this)),window.addEventListener("mouseup",this.handleMouseUp.bind(this)),window.addEventListener("touchstart",this.handleTouchStart.bind(this)),window.addEventListener("touchend",this.handleTouchEnd.bind(this))}removeEventListeners(){window.removeEventListener("keydown",this.handleKeyDown.bind(this)),window.removeEventListener("keyup",this.handleKeyUp.bind(this)),window.removeEventListener("mousedown",this.handleMouseDown.bind(this)),window.removeEventListener("mouseup",this.handleMouseUp.bind(this)),window.removeEventListener("touchstart",this.handleTouchStart.bind(this)),window.removeEventListener("touchend",this.handleTouchEnd.bind(this))}handleKeyDown(t){this.keys[t.key]=!0,(t.key===" "||t.key==="ArrowUp")&&(this.isFlapping=!0,t.preventDefault())}handleKeyUp(t){this.keys[t.key]=!1}handleMouseDown(t){this.mouseDown=!0,this.isFlapping=!0}handleMouseUp(t){this.mouseDown=!1}handleTouchStart(t){this.touchActive=!0,this.isFlapping=!0,t.preventDefault()}handleTouchEnd(t){this.touchActive=!1,t.preventDefault()}isKeyPressed(t){return this.keys[t]===!0}isFlapActive(){return this.isKeyPressed(" ")||this.isKeyPressed("ArrowUp")||this.mouseDown||this.touchActive}}const u=200,U=400,D=100,m=150,A=.8,w=1.5;class C{constructor(){s(this,"canvas");s(this,"context");s(this,"bird");s(this,"grounds",[]);s(this,"pipes",[]);s(this,"background");s(this,"scoreEffects",[]);s(this,"powerUps",[]);s(this,"powerUpEffects",[]);s(this,"entities",[]);s(this,"inputHandler");s(this,"lastTime",0);s(this,"score",0);s(this,"highScore",0);s(this,"gameOver",!1);s(this,"isPaused",!1);s(this,"pipeSpawnTimer",0);s(this,"pipeSpawnInterval",w);s(this,"powerUpSpawnTimer",0);s(this,"powerUpSpawnInterval",10);s(this,"gameWidth");s(this,"gameHeight");s(this,"currentGameSpeed",u);s(this,"currentPipeGap",m);s(this,"useSpecialPipes",!1);s(this,"selectedBirdColor","yellow");s(this,"hasSlowMotion",!1);s(this,"slowMotionTimer",0);s(this,"slowMotionDuration",5);s(this,"hasScoreBoost",!1);s(this,"scoreBoostTimer",0);s(this,"scoreBoostDuration",10);s(this,"sounds",{});s(this,"isSoundEnabled",!0);this.canvas=document.getElementById("game-canvas"),this.context=this.canvas.getContext("2d"),this.gameWidth=480,this.gameHeight=640,this.canvas.width=this.gameWidth,this.canvas.height=this.gameHeight;const t=localStorage.getItem("flappyBirdHighScore");t&&(this.highScore=parseInt(t));const i=localStorage.getItem("flappyBirdColor");i&&["yellow","red","blue"].includes(i)&&(this.selectedBirdColor=i,this.updateCharacterSelectionUI()),this.loadSounds(),this.inputHandler=new L,this.init(),this.setupEventListeners()}updateCharacterSelectionUI(){document.querySelectorAll(".character-option").forEach(e=>e.classList.remove("selected"));const i=document.querySelector(`.character-option[data-color="${this.selectedBirdColor}"]`);i&&i.classList.add("selected")}loadSounds(){const t={flap:"wing.ogg",score:"point.ogg",hit:"hit.ogg",die:"die.ogg",swoosh:"swoosh.ogg"};for(const[i,e]of Object.entries(t)){const o=new Audio(`./assets/audio/${e}`);this.sounds[i]=o}}playSound(t){if(this.isSoundEnabled&&this.sounds[t]){const i=this.sounds[t].cloneNode();i.volume=.5,i.play().catch(e=>console.log("Error playing sound:",e))}}toggleSound(){this.isSoundEnabled=!this.isSoundEnabled}init(){this.currentGameSpeed=u,this.currentPipeGap=m,this.pipeSpawnInterval=w,this.useSpecialPipes=!1,this.hasSlowMotion=!1,this.slowMotionTimer=0,this.hasScoreBoost=!1,this.scoreBoostTimer=0,this.bird=new E(this.gameWidth*.3,this.gameHeight/2,this.selectedBirdColor),this.background=new x(this.gameWidth,this.gameHeight);const t=112,i=this.gameHeight-t/2;this.grounds=[];for(let e=0;e<3;e++){const o=new I(this.gameWidth/2+e*this.gameWidth,i,this.gameWidth,t,this.currentGameSpeed);this.grounds.push(o)}this.score=0,this.gameOver=!1,this.isPaused=!1,this.pipeSpawnTimer=0,this.powerUpSpawnTimer=0,this.pipes=[],this.powerUps=[],this.scoreEffects=[],this.powerUpEffects=[],this.entities=[this.background,this.bird,...this.grounds],document.getElementById("start-screen").style.display="flex",document.getElementById("game-over-screen").style.display="none"}setupEventListeners(){document.getElementById("start-button").addEventListener("click",()=>{this.start()}),document.getElementById("restart-button").addEventListener("click",()=>{this.restart()}),window.addEventListener("keydown",i=>{(i.key==="p"||i.key==="P")&&this.togglePause()});const t=document.querySelectorAll(".character-option");t.forEach(i=>{i.addEventListener("click",e=>{const o=e.currentTarget,n=o.getAttribute("data-color");n&&(this.selectedBirdColor=n,localStorage.setItem("flappyBirdColor",n),t.forEach(h=>h.classList.remove("selected")),o.classList.add("selected"),this.bird&&this.bird.setColor(n),this.playSound("swoosh"))})})}start(){document.getElementById("start-screen").style.display="none",this.playSound("swoosh"),this.lastTime=performance.now(),requestAnimationFrame(this.gameLoop.bind(this))}restart(){document.getElementById("game-over-screen").style.display="none",this.playSound("swoosh"),this.init(),this.start()}togglePause(){this.isPaused=!this.isPaused,this.isPaused?(this.context.fillStyle="rgba(0, 0, 0, 0.5)",this.context.fillRect(0,0,this.gameWidth,this.gameHeight),this.context.fillStyle="white",this.context.font="36px Arial",this.context.textAlign="center",this.context.fillText("PAUSED",this.gameWidth/2,this.gameHeight/2),this.context.font="24px Arial",this.context.fillText("Press P to resume",this.gameWidth/2,this.gameHeight/2+40)):(this.lastTime=performance.now(),requestAnimationFrame(this.gameLoop.bind(this)))}handleFlap(){!this.gameOver&&!this.isPaused&&(this.bird.flap(),this.playSound("flap"))}updateDifficulty(){const i=1+Math.floor(this.score/5)*.1;this.currentGameSpeed=Math.min(u*i,U);const e=Math.floor(this.score/10)*5;this.currentPipeGap=Math.max(m-e,D);const o=Math.floor(this.score/15)*.1;this.pipeSpawnInterval=Math.max(w-o,A),this.useSpecialPipes=this.score>=25,this.updateEntitySpeeds()}updateEntitySpeeds(){for(const t of this.grounds)t.setSpeed(this.currentGameSpeed);this.background.setSpeed(this.currentGameSpeed)}gameLoop(t){const i=(t-this.lastTime)/1e3;if(this.lastTime=t,!this.isPaused){this.context.clearRect(0,0,this.gameWidth,this.gameHeight),this.inputHandler.isFlapping&&(this.handleFlap(),this.inputHandler.isFlapping=!1),this.updateDifficulty(),this.updatePowerUpEffects(i),this.gameOver||(this.pipeSpawnTimer+=i,this.pipeSpawnTimer>=this.pipeSpawnInterval&&(this.pipeSpawnTimer=0,this.spawnPipes()),this.powerUpSpawnTimer+=i,this.powerUpSpawnTimer>=this.powerUpSpawnInterval&&(this.powerUpSpawnTimer=0,this.spawnPowerUp()));for(const e of this.entities)e.update(i);this.gameOver||this.checkCollisions(),this.gameOver||this.checkPipePassed(),this.gameOver||this.checkPowerUpCollected(),this.cleanupScoreEffects(),this.cleanupPowerUpEffects(),this.cleanupPipes(),this.cleanupPowerUps();for(const e of this.entities)e.render(this.context);this.drawScore(),this.drawActivePowerUps(),this.gameOver||requestAnimationFrame(this.gameLoop.bind(this))}}spawnPipes(){const t=Math.min(1,this.score/50),i=this.gameHeight*(.2+t*.1),e=this.gameHeight*(.8-t*.1),o=i+Math.random()*(e-i),n=this.currentPipeGap,h=this.useSpecialPipes&&Math.random()<.2,a=o,r=new b(this.gameWidth+100,o-n/2,a,!0,h,this.currentGameSpeed),l=o+n/2,p=this.gameHeight-l,c=new b(this.gameWidth+100,l,p,!1,h,this.currentGameSpeed);this.pipes.push(r,c),this.entities.push(r,c)}checkCollisions(){for(const t of this.grounds)if(this.bird.collidesWith(t)){this.handleCollision();return}for(const t of this.pipes)if(this.bird.collidesWith(t)){this.handleCollision();return}if(this.bird.position.y-this.bird.height/2<0){this.handleCollision();return}}handleCollision(){if(this.bird.hasShield){this.bird.hasShield=!1,this.playSound("hit");return}this.handleGameOver()}checkPipePassed(){for(const t of this.pipes)if(t.checkPassed(this.bird.position.x)){const i=this.hasScoreBoost?2:1;this.score+=i,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("flappyBirdHighScore",this.highScore.toString())),this.addScoreEffect(i),this.playSound("score");break}}addScoreEffect(t){const i=new M(this.bird.position.x,this.bird.position.y-50,t===1?"+1":"+2");this.scoreEffects.push(i),this.entities.push(i)}cleanupScoreEffects(){for(let t=this.scoreEffects.length-1;t>=0;t--)if(this.scoreEffects[t].isExpired()){const i=this.entities.indexOf(this.scoreEffects[t]);i!==-1&&this.entities.splice(i,1),this.scoreEffects.splice(t,1)}}cleanupPipes(){for(let t=this.pipes.length-1;t>=0;t--)if(this.pipes[t].position.x+this.pipes[t].width/2<0){const i=this.entities.indexOf(this.pipes[t]);i!==-1&&this.entities.splice(i,1),this.pipes.splice(t,1)}}drawScore(){this.context.fillStyle="white",this.context.strokeStyle="black",this.context.lineWidth=3,this.context.font="bold 36px Arial",this.context.textAlign="center",this.context.textBaseline="top",this.context.strokeText(this.score.toString(),this.gameWidth/2,20),this.context.fillText(this.score.toString(),this.gameWidth/2,20),this.drawDifficultyIndicator()}drawDifficultyIndicator(){const i=Math.min(5,Math.floor(this.score/10)),e=20,o=5,n=this.gameWidth-e*5-o*4-10,h=20;for(let a=0;a<5;a++){const r=n+a*(e+o);this.drawStar(r,h,e,"#333333")}for(let a=0;a<i;a++){const r=n+a*(e+o);this.drawStar(r,h,e,"#FFD700")}}drawStar(t,i,e,o){const h=e/2,a=h/2;this.context.beginPath(),this.context.fillStyle=o,this.context.strokeStyle="black",this.context.lineWidth=1;for(let r=0;r<5*2;r++){const l=r%2===0?h:a,p=Math.PI/5*r,c=t+l*Math.sin(p),g=i+l*Math.cos(p);r===0?this.context.moveTo(c,g):this.context.lineTo(c,g)}this.context.closePath(),this.context.fill(),this.context.stroke()}handleGameOver(){this.gameOver||(this.gameOver=!0,this.playSound("hit"),setTimeout(()=>{this.playSound("die")},500),this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("flappyBirdHighScore",this.highScore.toString())),document.getElementById("final-score").textContent=this.score.toString(),document.getElementById("high-score").textContent=this.highScore.toString(),this.updateDifficultyStars(),setTimeout(()=>{document.getElementById("game-over-screen").style.display="flex"},1e3))}updateDifficultyStars(){const i=Math.min(5,Math.floor(this.score/10));for(let e=1;e<=5;e++){const o=document.getElementById(`star-${e}`);o&&(e<=i?o.classList.add("filled"):o.classList.remove("filled"))}}updatePowerUpEffects(t){this.hasSlowMotion&&(this.slowMotionTimer+=t,this.slowMotionTimer>=this.slowMotionDuration&&(this.hasSlowMotion=!1,this.updateEntitySpeeds())),this.hasScoreBoost&&(this.scoreBoostTimer+=t,this.scoreBoostTimer>=this.scoreBoostDuration&&(this.hasScoreBoost=!1))}spawnPowerUp(){if(this.score<10)return;const t=this.gameHeight*.2,i=this.gameHeight*.7,e=t+Math.random()*(i-t),o=["shield","slowmo","score"],n=o[Math.floor(Math.random()*o.length)],h=new k(this.gameWidth+100,e,n);h.setSpeed(this.currentGameSpeed),this.powerUps.push(h),this.entities.push(h)}checkPowerUpCollected(){for(let t=this.powerUps.length-1;t>=0;t--){const i=this.powerUps[t];if(!i.isCollected&&this.bird.collidesWith(i)){i.isCollected=!0,this.applyPowerUpEffect(i.type,i.position.x,i.position.y),this.playSound("score");const e=this.entities.indexOf(i);e!==-1&&this.entities.splice(e,1),this.powerUps.splice(t,1)}}}applyPowerUpEffect(t,i,e){const o=new B(i,e,t);switch(this.powerUpEffects.push(o),this.entities.push(o),t){case"shield":this.bird.activateShield();break;case"slowmo":this.hasSlowMotion=!0,this.slowMotionTimer=0,this.currentGameSpeed=u*.5,this.updateEntitySpeeds();break;case"score":this.hasScoreBoost=!0,this.scoreBoostTimer=0;break}}cleanupPowerUpEffects(){for(let t=this.powerUpEffects.length-1;t>=0;t--)if(this.powerUpEffects[t].isExpired()){const i=this.entities.indexOf(this.powerUpEffects[t]);i!==-1&&this.entities.splice(i,1),this.powerUpEffects.splice(t,1)}}cleanupPowerUps(){for(let t=this.powerUps.length-1;t>=0;t--)if(this.powerUps[t].position.x+this.powerUps[t].width/2<0){const i=this.entities.indexOf(this.powerUps[t]);i!==-1&&this.entities.splice(i,1),this.powerUps.splice(t,1)}}drawActivePowerUps(){let n=60;this.bird.hasShield&&(this.drawPowerUpIndicator(10,n,30,"shield",this.bird.shieldTimer/this.bird.shieldDuration),n+=40),this.hasSlowMotion&&(this.drawPowerUpIndicator(10,n,30,"slowmo",this.slowMotionTimer/this.slowMotionDuration),n+=40),this.hasScoreBoost&&this.drawPowerUpIndicator(10,n,30,"score",this.scoreBoostTimer/this.scoreBoostDuration)}drawPowerUpIndicator(t,i,e,o,n){const h=e/2;switch(this.context.fillStyle="rgba(0, 0, 0, 0.5)",this.context.beginPath(),this.context.arc(t+h,i+h,h,0,Math.PI*2),this.context.fill(),this.context.strokeStyle="white",this.context.lineWidth=2,this.context.beginPath(),this.context.arc(t+h,i+h,h-2,-Math.PI/2,-Math.PI/2+(1-n)*Math.PI*2),this.context.stroke(),this.context.fillStyle="white",this.context.strokeStyle="black",this.context.lineWidth=1,o){case"shield":this.context.beginPath(),this.context.moveTo(t+h,i+h*.5),this.context.lineTo(t+h+h*.6,i+h+h*.3),this.context.lineTo(t+h,i+h+h*.7),this.context.lineTo(t+h-h*.6,i+h+h*.3),this.context.closePath(),this.context.fill(),this.context.stroke();break;case"slowmo":this.context.beginPath(),this.context.arc(t+h,i+h,h*.6,0,Math.PI*2),this.context.fill(),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t+h,i+h),this.context.lineTo(t+h,i+h-h*.4),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t+h,i+h),this.context.lineTo(t+h+h*.3,i+h),this.context.stroke();break;case"score":const a=5,r=h*.7,l=r*.4;this.context.beginPath();for(let p=0;p<a*2;p++){const c=p%2===0?r:l,g=Math.PI/a*p-Math.PI/2,y=t+h+c*Math.cos(g),S=i+h+c*Math.sin(g);p===0?this.context.moveTo(y,S):this.context.lineTo(y,S)}this.context.closePath(),this.context.fill(),this.context.stroke();break}}}document.addEventListener("DOMContentLoaded",()=>{const f=new C,t=document.getElementById("start-screen"),i=document.getElementById("game-over-screen"),e=document.getElementById("start-button"),o=document.getElementById("restart-button"),n=document.getElementById("final-score"),h=document.getElementById("high-score");e.addEventListener("click",()=>{t.style.display="none",f.start()}),o.addEventListener("click",()=>{i.style.display="none",f.restart()}),document.addEventListener("gameOver",a=>{const r=a,l=r.detail.score,p=r.detail.highScore;n.textContent=l.toString(),h.textContent=p.toString(),i.style.display="flex"})});
//# sourceMappingURL=index-DLFyq6_7.js.map
